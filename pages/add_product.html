<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Product - ShopEasy</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        body {
            background: url('bg_image.jpeg') no-repeat center center fixed;
            background-size: cover;
            font-family: Arial, sans-serif;
        }
        .overlay {
            background: rgba(0,0,0,0.6);
            position: fixed;
            inset: 0;
        }
        .form-container {
            max-width: 550px;
            background: #fff;
            padding: 30px;
            border-radius: 12px;
        }
    </style>
</head>
<body>

<div class="overlay d-flex justify-content-center align-items-center">
    <div class="form-container shadow">

        <h3 class="text-center fw-bold mb-3 text-dark">Add New Product</h3>

        <form id="addProductForm">
            <div class="mb-3">
                <label class="form-label fw-semibold">Product Name</label>
                <input type="text" id="productName" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label fw-semibold">Price (â‚¹)</label>
                <input type="number" id="productPrice" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label fw-semibold">Description</label>
                <textarea id="productDescription" class="form-control" rows="3" required></textarea>
            </div>

            <div class="mb-3">
                <label class="form-label fw-semibold">Upload Image</label>
                <input type="file" id="imageFile" class="form-control" accept="image/*" required>
            </div>

            <button class="btn btn-primary w-100 mt-2" type="submit">Add Product</button>
        </form>

    </div>
</div>

<script>
    // Allow Admin only
    const admin = JSON.parse(localStorage.getItem("loggedInUser"));
    if(!admin || admin.email !== "admin@gmail.com"){
        alert("Admin access only!");
        window.location.href = "login.html";
    }

    document.getElementById("addProductForm").addEventListener("submit", function(e){
        e.preventDefault();

        let name = productName.value.trim();
        let price = Number(productPrice.value);
        let description = productDescription.value.trim();
        let file = imageFile.files[0];

        if(!file){
            alert("Please upload an image!");
            return;
        }

        let reader = new FileReader();
        reader.onload = function(){
            let base64Image = reader.result;

            let products = JSON.parse(localStorage.getItem("products")) || [];

            products.push({
                id: Date.now(),
                name,
                price,
                description,
                image: base64Image
            });

            localStorage.setItem("products", JSON.stringify(products));

            alert("Product Added Successfully!");
            window.location.href = "products.html";
        };

        reader.readAsDataURL(file);
    });
</script>

</body>
</html>
